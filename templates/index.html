<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Futuristic Todo App</title>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Animated gradient background */
    body {
      background: linear-gradient(270deg, #1a2a6c, #b21f1f, #fdbb2d, #06b6d4);
      background-size: 800% 800%;
      animation: GradientAnimation 15s ease infinite;
    }
    @keyframes GradientAnimation {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    /* Neon glow effect */
    .neon-button {
      box-shadow: 0 0 8px rgba(0,255,246,0.7), 0 0 16px rgba(0,255,246,0.5);
    }
    .gradient-header {
      background: linear-gradient(90deg, #06b6d4, #3b82f6);
    }
    .due-soon {
      background-color: #facc15;
      color: #1f2937;
      padding: 0.25rem 0.5rem;
      border-radius: 0.375rem;
      font-size: 0.75rem;
      font-weight: 600;
    }
  </style>
</head>
<body class="text-gray-200 font-sans">
  <!-- Mount point -->
  <div id="root" class="min-h-screen flex items-center justify-center p-4"></div>

  <!-- React + Babel -->
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <script type="text/babel">
    const { useState, useEffect } = React;

    function TodoApp() {
      const [todos, setTodos] = useState([]);
      const [filter, setFilter] = useState('all');
      const [searchTerm, setSearchTerm] = useState('');
      const [newTodo, setNewTodo] = useState({ title: '', due: '' });
      const [editingId, setEditingId] = useState(null);
      const [editTodo, setEditTodo] = useState({ title: '', due: '' });

      // Load from localStorage
      useEffect(() => {
        const saved = JSON.parse(localStorage.getItem('todos') || '[]');
        setTodos(saved);
      }, []);
      // Save to localStorage
      useEffect(() => {
        localStorage.setItem('todos', JSON.stringify(todos));
      }, [todos]);

      // Filter and search
      const filtered = todos
        .filter(t => filter === 'active' ? !t.completed : true)
        .filter(t => t.title.toLowerCase().includes(searchTerm.toLowerCase()));

      const isDueSoon = due => {
        const diff = (new Date(due) - new Date()) / (1000 * 60 * 60 * 24);
        return diff >= 0 && diff < 3;
      };

      // CRUD + utilities
      const addTodo = () => {
        if (!newTodo.title || !newTodo.due) return;
        const todo = { id: Date.now(), ...newTodo, completed: false };
        setTodos([...todos, todo]);
        setNewTodo({ title: '', due: '' });
      };
      const startEdit = t => { setEditingId(t.id); setEditTodo({ title: t.title, due: t.due }); };
      const saveEdit = id => { setTodos(todos.map(t => t.id === id ? { ...t, ...editTodo } : t)); setEditingId(null); };
      const deleteTodo = id => { setTodos(todos.filter(t => t.id !== id)); };
      const markAllDone = () => { setTodos(todos.map(t => ({ ...t, completed: true }))); };
      const clearAll = () => { setTodos([]); };

      return (
        <div className="max-w-lg w-full bg-gray-800 rounded-3xl overflow-hidden shadow-2xl">
          <header className="gradient-header px-6 py-4">
            <h1 className="text-2xl font-bold text-white">âœ¨ Futuristic Todos</h1>
            <div className="mt-3 flex gap-2">
              <button onClick={() => setFilter('all')} className={`px-3 py-1 rounded-lg ${filter==='all'?'bg-white text-gray-900 neon-button':'bg-gray-700'}`}>All</button>
              <button onClick={() => setFilter('active')} className={`px-3 py-1 rounded-lg ${filter==='active'?'bg-white text-gray-900 neon-button':'bg-gray-700'}`}>Active</button>
            </div>
            <div className="mt-3 flex gap-2">
              <button onClick={markAllDone} className="px-3 py-1 bg-cyan-500 text-gray-900 rounded-lg neon-button">Mark All Done</button>
              <button onClick={clearAll} className="px-3 py-1 bg-red-500 text-gray-900 rounded-lg neon-button">Clear All</button>
            </div>
            <div className="mt-3">
              <input
                className="w-full px-3 py-2 rounded-lg bg-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-cyan-400"
                placeholder="Search tasks..."
                value={searchTerm}
                onChange={e => setSearchTerm(e.target.value)}
              />
            </div>
          </header>
          <main className="p-6 space-y-4 h-96 overflow-y-auto">
            {filtered.length === 0
              ? <p className="text-gray-500 text-center mt-20">No matching tasks</p>
              : filtered.map(t => (
                <div key={t.id} className={`flex justify-between items-center bg-gray-900 border border-gray-700 rounded-xl p-4 hover:border-cyan-400 transition ${t.completed?'opacity-50 line-through':''}`}>
                  {editingId===t.id ? (
                    <div className="flex-1 space-x-2">
                      <input className="bg-gray-800 border border-gray-600 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-cyan-400" value={editTodo.title} onChange={e => setEditTodo({...editTodo, title: e.target.value})} />
                      <input type="date" className="bg-gray-800 border border-gray-600 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-cyan-400" value={editTodo.due} onChange={e => setEditTodo({...editTodo, due: e.target.value})} />
                      <button onClick={() => saveEdit(t.id)} className="ml-2 px-3 py-1 bg-cyan-500 text-gray-900 font-semibold rounded-lg neon-button">Save</button>
                    </div>
                  ) : (
                    <>
                      <div>
                        <p className="font-medium text-white inline-block">{t.title}</p>
                        {isDueSoon(t.due) && <span className="ml-2 due-soon">Due Soon</span>}
                        <p className="text-sm text-gray-400 mt-1">Due: {new Date(t.due).toLocaleDateString()}</p>
                      </div>
                      <div className="flex gap-2">
                        <button onClick={() => startEdit(t)} className="px-2 py-1 bg-yellow-500 rounded-lg text-gray-900 font-medium neon-button">Edit</button>
                        <button onClick={() => deleteTodo(t.id)} className="px-2 py-1 bg-red-500 rounded-lg text-gray-900 font-medium neon-button">Delete</button>
                      </div>
                    </>
                  )}
                </div>
              ))}
          </main>
          <footer className="px-6 py-4 bg-gray-700 flex gap-2">
            <input
              className="flex-1 bg-gray-800 border border-gray-600 rounded-xl px-3 py-2 focus:outline-none focus:ring-2 focus:ring-cyan-400"
              placeholder="New task"
              value={newTodo.title}
              onChange={e => setNewTodo({...newTodo, title: e.target.value})}
            />
            <input
              type="date"
              className="bg-gray-800 border border-gray-600 rounded-xl px-3 py-2 focus:outline-none focus:ring-2 focus:ring-cyan-400"
              value={newTodo.due}
              onChange={e => setNewTodo({...newTodo, due: e.target.value})}
            />
            <button onClick={addTodo} className="px-6 py-2 bg-cyan-500 rounded-xl font-semibold text-gray-900 neon-button">Add</button>
          </footer>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<TodoApp />);
  </script>
</body>
</html>
